---
title: "[Spring] spring ê¸°ë³¸1"
layout: post
subtitle: Spring
date: '2021-04-14-23:45:51 +0900'

categories: study
tags: Spring
# layout: post
# title:  WebFrontEnd
# subtitle:   "ì‹œì‘í•˜ê¸°"
# categories: study
# tags: java
comments: true
---

## JPA, Repository

- RDBMS, ì¤„ì—¬ì„œ RDBëŠ” ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë§í•©ë‹ˆë‹¤.
- H2ëŠ” RDBMSì˜ í•œ ì¢…ë¥˜ë¡œ, ì„œë²„ê°€ ì¼œì ¸ìˆëŠ” ë™ì•ˆì—ë§Œ ì‘ë™í•˜ëŠ” RDBì…ë‹ˆë‹¤.
- SQLì€ ë°ì´í„°ë¥¼ ì½ê³ , ì €ì¥í•˜ê³ , ë³€ê²½í•˜ê³ , ì‚­ì œí•˜ëŠ” êµ¬ì²´ì ì¸ ë¬¸ë²•ì…ë‹ˆë‹¤.


ìŠ¤í”„ë§ì€ ìë°”ë¡œ ì‘ë™í•˜ê³ , ë°ì´í„°ë² ì´ìŠ¤ëŠ” SQLë¡œ ì‘ë™í•©ë‹ˆë‹¤.
í•œêµ­ì–´ì™€ ì˜ì–´ ì‚¬ì´ì—ëŠ” ë²ˆì—­ê¸°ê°€ í•„ìš”í•˜ì£ ?
ìë°”ë¥¼ ìœ„í•œ ë²ˆì—­ê¸°, JPA ì‚¬ìš©ë²•ì„ ë°°ì›Œë´…ë‹ˆë‹¤.

- JPA(Spring Data JPA)ëŠ” ìŠ¤í”„ë§ì„ ìœ„í•´ íƒœì–´ë‚œ ë…€ì„ì¸ë°ìš”.
- Javaë¡œ ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ SQLë¡œ ë²ˆì—­í•´ì¤„ ë¿ë§Œ ì•„ë‹ˆë¼, ê¸°ë³¸ì ì¸ ê¸°ëŠ¥ì´ ê±°ì˜ ì™„ë²½í•˜ê²Œ ë“¤ì–´ìˆìŠµë‹ˆë‹¤.
- RepositoryëŠ” JPAë¥¼ ì‘ë™ì‹œí‚¤ëŠ” ë§¤ê°œì²´ì…ë‹ˆë‹¤.

í´ë¼ì´ì–¸íŠ¸ - ì„œë²„ ê°„ì˜ ì•½ì†ì¸ APIì™€ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ëŠ” êµ¬ì²´ì ì¸ ë°©ë²•ì— ëŒ€í•´ ë°°ì›ë‹ˆë‹¤.

- API ìš”ì²­ì—ë„ ë‹¤ì–‘í•œ ë°©ì‹ì´ ìˆìŠµë‹ˆë‹¤. ìƒì„±, ì¡°íšŒ, ìˆ˜ì •, ì‚­ì œ ê°ê°ì— ë§ëŠ” ë°©ë²•ì„ ì•Œì•„ë´…ë‹ˆë‹¤.
- ìŠ¤í”„ë§ì€ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ëŠ” ë°©ë²•ì„ ê°•ì œí•©ë‹ˆë‹¤. ì–´ë–»ê²Œ í•˜ë©´ ì˜¬ë°”ë¥´ê²Œ ì£¼ê³ ë°›ì„ ìˆ˜ ìˆëŠ”ì§€ ë°°ì›ë‹ˆë‹¤.
- í˜„ì—…ì—ì„œëŠ” ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ì„ ë•Œ, DTOë¥¼ ë°˜ë“œì‹œ ì´ìš©í•©ë‹ˆë‹¤. ì™œ ê·¸ëŸ¬í•œì§€ ì´ìœ ì™€ ë°©ë²•ì„ ë°°ì›ë‹ˆë‹¤.


---

- JPAë€?

    JPAëŠ”, SQLì„ ì“°ì§€ ì•Šê³  ë°ì´í„°ë¥¼ ìƒì„±, ì¡°íšŒ, ìˆ˜ì •, ì‚­ì œí•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ë²ˆì—­ê¸°ì…ë‹ˆë‹¤.

- JPAê°€ ì—†ë‹¤ë©´?


    - ìë°” ì§œë‹¤ê°€ ê°‘ìê¸° SQL ì§œê³ , ê·¸ê±¸ ì˜ ë§ì¶”ì–´ ë„£ì–´ì•¼ í•©ë‹ˆë‹¤. ë³µì¡í•˜ë„¤ìš” ğŸ˜‡



- JPAê°€ ìˆë‹¤ë©´?

    - ì„¤ì •ì€ ì•„ë˜ í•œ ì¤„ì´ë©´ ëë‚˜ê³ ìš”

```sql
        implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
```



- Domain, Repository ì†Œê°œ




    - ìë°”ë¡œ DBë¥¼ ì‚¬ìš©í•˜ë„ë¡ ë„ì™€ì£¼ëŠ” ë…€ì„ì´ JPA ë¼ê³  ë§ì”€ë“œë ¸ìŠµë‹ˆë‹¤.
    - ê·¸ëŸ¼ DBë¥¼ ì´ìš©í•˜ëŠ”ë° í•µì‹¬ì´ì—ˆë˜ "í…Œì´ë¸”"ê³¼ "SQL"ê³¼ ë™ì¼í•œ ê°œë…ì˜ ìë°” ìš©ì–´ê°€ ìˆê² ì£ ?
    - "í…Œì´ë¸”"ì€ Domain, "SQL"ì€ Repository ì…ë‹ˆë‹¤.
- Domain, Repository ë„ì…í•˜ê¸°

    ìš°ë¦¬ëŠ” courses ë¼ëŠ” í…Œì´ë¸”ì— title, tutor ë¼ëŠ” ì»¬ëŸ¼ì„ ë§Œë“¤ì–´ ë‘ì—ˆìŠµë‹ˆë‹¤.
    ì´ê²ƒì´ ìë°”ë¡œ ì–´ë–»ê²Œ í‘œí˜„ë˜ëŠ”ì§€ ì‚´í´ë³¼ê²Œìš”!

    1. src > main > java > com.sparta.week02ì— domain ì´ë¼ëŠ” íŒ¨í‚¤ì§€ë¥¼ ë§Œë“­ë‹ˆë‹¤.
    2. Course.java, CourseRepository.java íŒŒì¼ì„ ë§Œë“­ë‹ˆë‹¤.
    3. ** Course.java í´ë˜ìŠ¤**

        ```java
        @NoArgsConstructor // ê¸°ë³¸ìƒì„±ìë¥¼ ëŒ€ì‹  ìƒì„±í•´ì¤ë‹ˆë‹¤.
        @Entity // í…Œì´ë¸”ì„ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
        public class Course {

            @Id // ID ê°’, Primary Keyë¡œ ì‚¬ìš©í•˜ê² ë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤.
            @GeneratedValue(strategy = GenerationType.AUTO) // ìë™ ì¦ê°€ ëª…ë ¹ì…ë‹ˆë‹¤.
            private Long id;

            @Column(nullable = false) // ì»¬ëŸ¼ ê°’ì´ê³  ë°˜ë“œì‹œ ê°’ì´ ì¡´ì¬í•´ì•¼ í•¨ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
            private String title;

            @Column(nullable = false)
            private String tutor;

            public String getTitle() {
                return this.title;
            }

            public String getTutor() {
                return this.tutor;
            }

            public Course(String title, String tutor) {
                this.title = title;
                this.tutor = tutor;
            }
        }
        ```

    4. ** CourseRepository.java ì¸í„°í˜ì´ìŠ¤**

        ```java
        public interface CourseRepository extends JpaRepository<Course, Long> {
        }
        ```

    - Interface ë€?
        - JPAëŠ” Repositoryë¥¼ í†µí•´ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        - ì¸í„°í˜ì´ìŠ¤ëŠ” í´ë˜ìŠ¤ì—ì„œ ë©¤ë²„ê°€ ë¹ ì§„, ë©”ì†Œë“œ ëª¨ìŒì§‘ì´ë¼ê³  ë³´ì‹œë©´ ë©ë‹ˆë‹¤.

---

- ** SQLì´ ë³´ì´ë„ë¡ application.properties ì„¸íŒ…**

    ```java
    spring.jpa.show-sql=true
    ```

- JPA ì‚¬ìš©í•´ë³´ê¸°
    - ** JPA ì‹¤í–‰ ì½”ë“œ**

        ```java
        // Week02Application.java ì˜ main í•¨ìˆ˜ ì•„ë˜ì— ë¶™ì—¬ì£¼ì„¸ìš”.
        @Bean
        public CommandLineRunner demo(CourseRepository repository) {
            return (args) -> {

            };
        }
        ```


    - **ì›¹ì½˜ì†” ì ‘ì†í•´ì„œ í™•ì¸í•´ë³´ê¸°**

        ```java
        SELECT * FROM course;
        ```

    ìœ„ ì½”ë“œëŠ” ë‚¯ì„  ê°œë…ì´ ê°‘ìê¸° ë§ì´ ë‚˜ì˜µë‹ˆë‹¤. í•˜ì§€ë§Œ ê²ë¨¹ì§€ ë§ê¸°! ì™œë‚˜í•˜ë©´ìš”..
    ìš°ë¦¬ ìˆ˜ì—…ì—ì„œ ì´ë²ˆë§Œ ì“°ê³  ë‹¤ì‹œëŠ” ì•ˆ ì“°ëŠ” ì½”ë“œì—ìš”.

    @Bean, ìµëª… í•¨ìˆ˜ ë“±ì€ ì‹¤ë¬´ì—ì„œ ì¤‘ìš”í•œ ê²ƒë“¤ì´ ë§ìŠµë‹ˆë‹¤.
    í•˜ì§€ë§Œ ì¤‘ìš”í•œ ê±´ ì§€ê¸ˆ ë‹¨ê³„ì—ì„œ í•„ìš”í•œê²Œ ì•„ë‹ˆë¼ëŠ” ê±°ì—ìš”.

    ì—¬ê¸°ì„œ ì „ë¶€ ì´í•´í•˜ìê³  í•˜ë©´, ê·¸ë¦¬ê³  ì•ìœ¼ë¡œ ëª¨ë¥´ëŠ”ê²Œ ë‚˜ì˜¬ ë•Œë§ˆë‹¤ 100% ì•Œê³  ë„˜ì–´ê°€ë ¤ê³  í•˜ë©´
    ìŠ¤í”„ë§ì€ ê·¸ ì–‘ì´ ë„ˆë¬´ë‚˜ ë°©ëŒ€í•´ì„œ ë²•ì „ ê°™ì€ ì±… ë‘ ê¶Œì€ ì¡±íˆ ë–¼ì•¼ í•  ê±°ì—ìš”.

    ê·¸ë ‡ê²Œ ê°œë°œì„ ìµíˆë©´ ë„ˆë¬´ ì˜¤ë˜ ê±¸ë¦½ë‹ˆë‹¤. ì§€ì³ìš”. ë§Œë“œëŠ” ì¬ë¯¸ë¥¼ ìŠì–´ë²„ë¦½ë‹ˆë‹¤.

--------

- ìƒì†ì˜ ê°œë…
    - "extends" ë¼ëŠ” ë‹¨ì–´ë¥¼ Repositoryì—ì„œ ë³´ì•˜ì–´ìš”. ì´ê²Œ ëŒ€ì²´ ë­˜ê¹Œìš”?
    - "í´ë˜ìŠ¤ì˜ ìƒì†"ì´ë¼ëŠ” ê°œë…ì¸ë°ìš”. "ì´ë¯¸ ë§Œë“¤ì–´ë‘”ê±° ê°€ì ¸ë‹¤ ì“°ì!" ë¼ê³  ì„ ì–¸í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
    - Tutor extends Person ê³¼ ê°™ì´ ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¢€ ë” ì‚´í´ë³¼ê¹Œìš”?

        ```java
        class Person {
        	private String name;
        	private String getName() {
        		return this.name;
        	}
        }

        class Tutor extends Person {
        	private String address;
        	// Person í´ë˜ìŠ¤ë¥¼ ìƒì†í–ˆê¸° ë•Œë¬¸ì—,
        	// name ë©¤ë²„ë³€ìˆ˜ì™€ getName() ë©”ì†Œë“œë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.
        }

        ```

- ìƒì† ì—°ìŠµí•´ë³´ê¸° - Timestamped

    DB ê¸°ë³¸ ì¤‘ì˜ ê¸°ë³¸ì€, "ìƒì„±ì¼ì"ì™€ "ìˆ˜ì •ì¼ì"ë¥¼ í•„ë“œë¡œ ê°€ì§€ëŠ” ê²ƒì…ë‹ˆë‹¤.

    - Course í´ë˜ìŠ¤ê°€ course í…Œì´ë¸”ì´ ë˜ëŠ” ê²ƒ, ì‚´í´ë³´ì…¨ì£ ?
    - Course í´ë˜ìŠ¤ì— ìƒì„±ì¼ì/ìˆ˜ì •ì¼ì ë©¤ë²„ë¥¼ ì¶”ê°€í•´ë³´ê² ìŠµë‹ˆë‹¤.
    - ** Timestamped.java**

        ```java
        @MappedSuperclass // ìƒì†í–ˆì„ ë•Œ, ì»¬ëŸ¼ìœ¼ë¡œ ì¸ì‹í•˜ê²Œ í•©ë‹ˆë‹¤.
        @EntityListeners(AuditingEntityListener.class) // ìƒì„±/ìˆ˜ì • ì‹œê°„ì„ ìë™ìœ¼ë¡œ ë°˜ì˜í•˜ë„ë¡ ì„¤ì •
        public class Timestamped {

            @CreatedDate // ìƒì„±ì¼ìì„ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
            private LocalDateTime createdAt;

            @LastModifiedDate // ë§ˆì§€ë§‰ ìˆ˜ì •ì¼ìì„ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
            private LocalDateTime modifiedAt;
        }
        ```

    - Course í´ë˜ìŠ¤ì— ì•„ë˜ì™€ ê°™ì´ ë¶‰ì€ìƒ‰ ê¸€ìë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.

        ```java
        class Course extends Timestamped {
        ```

    - Week02Application í´ë˜ìŠ¤ì— ë‹¤ìŒê³¼ ê°™ì´ ë¶‰ì€ìƒ‰ ê¸€ìë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.

        ```java
        @EnableJpaAuditing
        @SpringBootApplication
        public class Week02Application {
        ```

------


## JPA ì‹¬í™”


ğŸ–CRUDë€? ì •ë³´ê´€ë¦¬ì˜ ê¸°ë³¸ ê¸°ëŠ¥
â†’ ìƒì„± (Create)
â†’ ì¡°íšŒ (Read)
â†’ ë³€ê²½ (Update)
â†’ ì‚­ì œ (Delete)

JPAë¡œ ìœ„ì˜ ê¸°ëŠ¥ì„ í•˜ëŠ” ë°©ë²•ì„ ìµí˜€ë³´ê² ìŠµë‹ˆë‹¤.


## ì¸í…”ë¦¬ì œì´ì—ì„œ ctrl+ alt+l ëˆ„ë¥´ë©´ ìë™ì •ë ¬
