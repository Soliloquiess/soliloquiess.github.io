---
title: "[Spring] ìŠ¤í”„ë§ ë¹ˆê³¼ ì˜ì¡´ê´€ê³„~AOP"
layout: post
subtitle: Spring
date: "2021-06-05-01:58:53 +0900"

categories: study
tags: Spring
# layout: post
# title:  WebFrontEnd
# subtitle:   "ì‹œì‘í•˜ê¸°"
# categories: study
# tags: java
comments: true
---



### ìŠ¤í”„ë§ ë¹ˆê³¼ ì˜ì¡´ê´€ê³„

ì§€ê¸ˆê¹Œì§€ ì„œë¹„ìŠ¤ì™€ ë¦¬í¬ì§€í† ë¦¬ ë§Œë“¤ê³  ë©¤ë²„ ê°ì²´ ë§Œë“¤ê³  ì„œë¹„ìŠ¤ë¥¼ í†µí•´ì„œ ë©¤ë²„ë¥¼ íƒ€ì…í• ìˆ˜ ìˆê³  ë¦¬í¬ì§€í† ë¦¬ì— ì €ì¥í•˜ê³  í…ŒìŠ¤íŠ¸ ë§Œë“¤ê³ .

ì´ë²ˆì—” í™”ë©´ ë¶™ì¼ê±°.

```
private final MemberService memberService = new MemberService();

```

ì´ë ‡ê²Œ í•˜ë©´ ë‹¤ë¥¸ ì—¬ëŸ¬ ë©¤ë²„ ì»¨íŠ¸ë¡¤ëŸ¬ë“¤ì´ ê°€ì ¸ë‹¤ ì“¸ ìˆ˜ ìˆë‹¤.


ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë“±ë¡í•˜ë©´ í•˜ë‚˜ë§Œ ë“±ë¡ì´ ë¨.


![20210605_184516](/assets/20210605_184516.png)

MemberServiceë¥¼ ì°¾ì„ ìˆ˜ ì—†ë‹¤ëŠ”ë° ..?


@AutowiredëŠ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ ê°€ì ¸ì˜´.

ì—°ê²°ì„ ì‹œì¼œì£¼ëŠ”ë° ì•ˆë˜ë„¤ ì™œ?
ë©¤ë²„ì„œë¹„ìŠ¤ ê°€ë©´ ìˆœìˆ˜í•œ ìë°” í´ë˜ìŠ¤ì¸ë°
ì—ë…¸í…Œì´ì…˜ ë³´ê³  ê·œì¹™ì´ ìˆëŠ”ë° ìˆœìˆ˜í•œ ã„´ìë°”ì½”ë“œë¼ ì•„ë¬´ê²ƒë„ ì•ˆë¨ ê·¸ë˜ì„œ @Serviceë¥¼ ë„£ì–´ì£¼ë©´ ë¨.


- ìŠ¤í”„ë§ì„ ì‹œì‘í•  ë•Œ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¼ëŠ” í†µì´ ìƒê¸°ëŠ”ë° ê±°ê¸°ì— @Controller ì–´ë…¸í…Œì´ì…˜ì´ ìˆëŠ” í´ë˜ìŠ¤ëŠ” ê°ì²´ë¥¼ ìƒì„±í•´ì„œ ë„£ì–´ë‘ê³  ê´€ë¦¬ë¥¼ í•´ì¤€ë‹¤.

- Controller, Service, Repository = ì •í˜•í™” ëœ íŒ¨í„´
Controllerì—ì„œ ì™¸ë¶€ ìš”ì²­ì„ ë°›ê³ , Serviceì—ì„œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ë§Œë“¤ê³  Repositoryì—ì„œ ë°ì´í„° ì €ì¥ì„ í•œë‹¤.

- ìƒì„±ìì— @Autowired ê°€ ìˆìœ¼ë©´ ìŠ¤í”„ë§ì´ ì—°ê´€ëœ ê°ì²´ë¥¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì—ì„œ ì°¾ì•„ì„œ ë„£ì–´ì¤€ë‹¤. ì´ë ‡ê²Œ ê°ì²´ ì˜ì¡´ê´€ê³„ë¥¼ ì™¸ë¶€ì—ì„œ ë„£ì–´ì£¼ëŠ” ê²ƒì„ DI (Dependency Injection), ì˜ì¡´ì„± ì£¼ì…ì´ë¼ í•œë‹¤.

- ì´ì „ í…ŒìŠ¤íŠ¸ì—ì„œëŠ” ê°œë°œìê°€ ì§ì ‘ ì£¼ì…í–ˆê³ , ì—¬ê¸°ì„œëŠ” @Autowiredì— ì˜í•´ ìŠ¤í”„ë§ì´ ì£¼ì…í•´ì¤€ë‹¤.


- ì¶œì²˜: https://velog.io/@abcdana/%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B9%88%EA%B3%BC-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%84




ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ì›ë¦¬
@Component ì• ë…¸í…Œì´ì…˜ì´ ìˆìœ¼ë©´ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ìë™ ë“±ë¡ëœë‹¤.
@Controller ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ìë™ ë“±ë¡ëœ ì´ìœ ë„ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ë•Œë¬¸ì´ë‹¤.
@Component ë¥¼ í¬í•¨í•˜ëŠ” ë‹¤ìŒ ì• ë…¸í…Œì´ì…˜ë„ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ìë™ ë“±ë¡ëœë‹¤.
@Controller
@Service
@Repository



![20210605_190342](/assets/20210605_190342.png)

ìŠ¤í”„ë§ ë”± ì˜¬ë¼ì˜¬ë•Œ ì»´í¬ë„ŒíŠ¸ ê´€ë ¨ ì–´ë…¸í…Œì´ì…˜ì´ ìˆìœ¼ë©´ ê°ì²´ ìƒì„±í•´ì„œ ë”± ë“±ë¡. AutowiredëŠ” ì´ ì—°ê´€ê´€ê³„. ì„ ì„ ì—°ê²°í•˜ëŠ”ê±°


memberService ì™€ memberRepository ê°€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ì—ˆë‹¤.
> ì°¸ê³ : ìŠ¤í”„ë§ì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ìŠ¤í”„ë§ ë¹ˆì„ ë“±ë¡í•  ë•Œ, ê¸°ë³¸ìœ¼ë¡œ ì‹±ê¸€í†¤ìœ¼ë¡œ ë“±ë¡í•œë‹¤(ìœ ì¼í•˜ê²Œ í•˜ë‚˜ë§Œ
ë“±ë¡í•´ì„œ ê³µìœ í•œë‹¤) ë”°ë¼ì„œ ê°™ì€ ìŠ¤í”„ë§ ë¹ˆì´ë©´ ëª¨ë‘ ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ë‹¤. ì„¤ì •ìœ¼ë¡œ ì‹±ê¸€í†¤ì´ ì•„ë‹ˆê²Œ ì„¤ì •í•  ìˆ˜
ìˆì§€ë§Œ, íŠ¹ë³„í•œ ê²½ìš°ë¥¼ ì œì™¸í•˜ë©´ ëŒ€ë¶€ë¶„ ì‹±ê¸€í†¤ì„ ì‚¬ìš©í•œë‹¤.


------



### ìŠ¤í”„ë§ ë¹ˆì„ ë“±ë¡í•˜ëŠ” 2ê°€ì§€ ë°©ë²•


##### ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ê³¼ ìë™ ì˜ì¡´ê´€ê³„ ì„¤ì •

@Controller, .. ë“± ì–´ë…¸í…Œì´ì…˜ì„ ì´ìš©í•´ì„œ í•œ ê²ƒì´ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ë°©ì‹
ìë°” ì½”ë“œë¡œ ì§ì ‘ ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡í•˜ê¸°
ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ì›ë¦¬
@Component ì–´ë…¸í…Œì´ì…˜ì´ ìˆìœ¼ë©´ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ìë™ ë“±ë¡ëœë‹¤.
@Controller ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ìë™ ë“±ë¡ëœ ì´ìœ ë„ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ë•Œë¬¸ì´ë‹¤.
@Component ë¥¼ í¬í•¨í•˜ëŠ” ë‹¤ìŒ ì• ë…¸í…Œì´ì…˜ë„ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ìë™ ë“±ë¡ëœë‹¤.
@Controller
@Service
@Repositor
ğŸ‘©ğŸ»â€ğŸ’»ì—¬ê¸°ì„œ ìƒê¸°ëŠ” ê¶ê¸ˆí•œ ì  !
â“ ì•„ë¬´ë°ë‚˜ @Component ì–´ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ë„ ë˜ë‚˜ìš”?

ì˜ˆë¥¼ ë“¤ì–´ ìŒ©ëš±ë§ê²Œ main > java > demo íŒ¨í‚¤ì§€ì— demo í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ ì–´ë…¸í…Œì´ì…˜ ë¶™ì—¬ë„ ë˜ë‚˜ìš”???
ğŸ“¢ ê¸°ë³¸ì ìœ¼ë¡œëŠ” ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì´ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ì§€ê¸ˆ ìš°ë¦¬ê°€ ì‹¤í–‰ ì‹œí‚¤ëŠ” í´ë˜ìŠ¤ í´ë”ê°€ hello.hellospring íŒ¨í‚¤ì§€ì´ë¯€ë¡œ ì´ í•˜ìœ„ì— í¬í•¨ëœ íŒŒì¼ë“¤ë§Œ ìŠ¤í”„ë§ì´ ë‹¤ ë’¤ì ¸ì„œ ìŠ¤ìº”í•©ë‹ˆë‹¤.
ì¶”ê°€ ì„¤ì •ì„ í†µí•´ ë“±ë¡í•  'ìˆ˜'ëŠ” ìˆìŠµë‹ˆë‹¤.




![20210605_190342](/assets/20210605_190342.png)

```

public class SpringConfig {

    @Bean
    public MemberService memberService(){
        return new MemberService(memberRepository());
    }

    @Bean
    public MemberRepository memberRepository(){
        return new MemoryMemberRepository();
        //ì¸í„°í˜ì´ìŠ¤ëŠ” ë‰´ê°€ ì•ˆëœë‹¤.
        //ë©¤ë²„ ì„œë¹„ìŠ¤ë‘ ë©¤ë²„ë¦¬í¬ì§€í† ë¦¬ë¥¼ ìŠ¤í”„ë§ì— ë“±ë¡í•˜ê³ 
    }
}


```

ì´ ê·¸ë¦¼ì„ ì´ë ‡ê²Œ êµ¬í˜„í–ˆë‹¤.

ë©¤ë²„ ì„œë¹„ìŠ¤ë‘ ë¦¬í¬ì§€í† ë¦¬ë¥¼ ìŠ¤í”„ë§ ì˜¬ë¼ì˜¬ë–„ ì»¨í…Œì´ë„ˆì— ì˜¬ë¦¬ê³  ë©¤ë²„ì„œë¹„ìŠ¤ëŠ”  ë©¤ë²„ë¦¬í¬ì§€í† ë¦¬ í˜¸ì¶œí•˜ê³  ìŠ¤í”„ë§ì— ë“±ë¡ëœ ë¦¬í¬ì§€í† ë¦¬ë¥¼ ë„£ì–´ì¤Œ. ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ìŠ¤í”„ë§ì´ ê´€ë¦¬í•˜ëŠ”ê±°



![20210605_193737](/assets/20210605_193737.png)

ì´ê±´ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì´ë¼ Autowired í•´ì£¼ë©´ ë¨.



XMLë¡œ ì„¤ì •í•˜ëŠ” ë°©ì‹ë„ ìˆì§€ë§Œ ìµœê·¼ì—ëŠ” ì˜ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ìƒëµí•œë‹¤.
ì´ëŸ´ì‘¤...ê°€... ë‚œ ìˆ˜ì—… ë•Œ ì´ë ‡ê²Œ ë°°ì› ëŠ”ê±¸?ã… ã…œ
DIì—ëŠ” í•„ë“œ ì£¼ì…, setter ì£¼ì…, ìƒì„±ì ì£¼ì… ì´ë ‡ê²Œ 3ê°€ì§€ ë°©ë²•ì´ ìˆë‹¤.
â†’ ì˜ì¡´ê´€ê³„ê°€ ì‹¤í–‰ì¤‘ì— ë™ì ìœ¼ë¡œ ë³€í•˜ëŠ” ê²½ìš°ëŠ” ê±°ì˜ ì—†ìœ¼ë¯€ë¡œ ìƒì„±ì ì£¼ì…ì„ ê¶Œì¥í•œë‹¤.
ì‹¤ë¬´ì—ì„œëŠ” ì£¼ë¡œ ì •í˜•í™”ëœ ì»¨íŠ¸ë¡¤ëŸ¬, ì„œë¹„ìŠ¤, ë¦¬í¬ì§€í† ë¦¬ ê°™ì€ ì½”ë“œëŠ” ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì„ ì‚¬ìš©í•œë‹¤. ê·¸ë¦¬ê³  ì •í˜•í™” ë˜ì§€ ì•Šê±°ë‚˜, ìƒí™©ì— ë”°ë¼ êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ë³€ê²½í•´ì•¼ í•˜ë©´ ì„¤ì •ì„ í†µí•´ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í•œë‹¤.
ğŸ“¢ì£¼ì˜ : @Autowired ë¥¼ í†µí•œ DIëŠ” helloConroller , memberService ë“±ê³¼ ê°™ì´ ìŠ¤í”„ë§ì´ ê´€ë¦¬í•˜ëŠ” ê°ì²´ì—ì„œë§Œ ë™ì‘í•œë‹¤.
â†’ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ì§€ ì•Šê³  ë‚´ê°€ ì§ì ‘ ìƒì„±í•œ ê°ì²´ì—ì„œëŠ” ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.

ì°¸ê³  : https://velog.io/@abcdana/%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B9%88%EA%B3%BC-%EC%9D%98%EC%A1%B4%EA%B4%80%EA%B3%84


- ì°¸ê³ : XMLë¡œ ì„¤ì •í•˜ëŠ” ë°©ì‹ë„ ìˆì§€ë§Œ ìµœê·¼ì—ëŠ” ì˜ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ìƒëµí•œë‹¤.
- ì°¸ê³ : DIì—ëŠ” í•„ë“œ ì£¼ì…, setter ì£¼ì…, ìƒì„±ì ì£¼ì… ì´ë ‡ê²Œ 3ê°€ì§€ ë°©ë²•ì´ ìˆë‹¤. ì˜ì¡´ê´€ê³„ê°€ ì‹¤í–‰ì¤‘ì—
ë™ì ìœ¼ë¡œ ë³€í•˜ëŠ” ê²½ìš°ëŠ” ê±°ì˜ ì—†ìœ¼ë¯€ë¡œ ìƒì„±ì ì£¼ì…ì„ ê¶Œì¥í•œë‹¤.
- ì°¸ê³ : ì‹¤ë¬´ì—ì„œëŠ” ì£¼ë¡œ ì •í˜•í™”ëœ ì»¨íŠ¸ë¡¤ëŸ¬, ì„œë¹„ìŠ¤, ë¦¬í¬ì§€í† ë¦¬ ê°™ì€ ì½”ë“œëŠ” ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì„ ì‚¬ìš©í•œë‹¤.
ê·¸ë¦¬ê³  ì •í˜•í™” ë˜ì§€ ì•Šê±°ë‚˜, ìƒí™©ì— ë”°ë¼ êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ë³€ê²½í•´ì•¼ í•˜ë©´ ì„¤ì •ì„ í†µí•´ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ
ë“±ë¡í•œë‹¤.
- ì£¼ì˜: @Autowired ë¥¼ í†µí•œ DIëŠ” helloConroller , memberService ë“±ê³¼ ê°™ì´ ìŠ¤í”„ë§ì´ ê´€ë¦¬í•˜ëŠ”
ê°ì²´ì—ì„œë§Œ ë™ì‘í•œë‹¤. ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ì§€ ì•Šê³  ë‚´ê°€ ì§ì ‘ ìƒì„±í•œ ê°ì²´ì—ì„œëŠ” ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ, DI ê´€ë ¨ëœ ìì„¸í•œ ë‚´ìš©ì€ ìŠ¤í”„ë§ í•µì‹¬ ì›ë¦¬ ê°•ì˜ì—ì„œ ì„¤ëª…í•œë‹¤.


ê·¸ë¦¬ê³   

```
@Autowiredì§€ìš°ê³  SpringConfig íŒŒì¼ ìƒì„± í›„ ì‹¤í–‰í•´ë³´ë‹ˆ beanì´ ì´ë¯¸ ì •ì˜ ë˜ì–´ ìˆë‹¤ëŠ” ì‹ì˜ ì˜¤ë¥˜ê°€ ë–´ìŠµë‹ˆë‹¤.

êµ¬ê¸€ë§ í•´ë³´ë‹ˆ spring boot 2.1 ì´í›„ë¡œëŠ” beanì„ overriding ëª»í•˜ë„ë¡ ì„¤ì •ë˜ì–´ìˆë‹¤ê³  í•˜ë”ë¼ê³ ìš”.

application.properties íŒŒì¼ì— spring.main.allow-bean-definition-overriding=true ë¥¼ ì¶”ê°€í•˜ë‹ˆ ì‘ë™í•˜ê¸´ í•˜ëŠ”ë°, ë¹ˆì´ ì˜¤ë²„ë¼ì´ë“œ ë  ê²½ìš°ì— ë¬´ìŠ¨ ë¬¸ì œì ì´ ë°œìƒí•˜ë‚˜ìš”?

ë­”ê°€ ë¬¸ì œì ì´ ìˆìœ¼ë‹ˆê¹Œ ìŠ¤í”„ë§ì—ì„œ ë””í´íŠ¸ ì„¤ì •ì„ ë°”ê¾¼ ê²ƒ ê°™ì€ë°... êµ¬ê¸€ë§ í•´ë„ í•´ê²°ë²•ë§Œ ë‚˜ì˜¤ê³  ì™œ ê·¸ëŸ°ì§€ëŠ” ì„¤ëª…ì´ ì—†ë„¤ìš”ã…œã…œ

```

ì´ëŸ° ì—ëŸ¬ ë‚¬ì—ˆëŠ”ë° @serviceë¥¼ ì§€ì›Œì£¼ë‹ˆ í•´ê²°ì´ ë˜ì—ˆë‹¤.


ë©”ì‹œì§€ë¥¼ ë¶„ì„í•´ë³´ë©´ MemberServiceê°€ ì´ë¯¸ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ì–´ì„œ SpringConfigì— ì •ì˜í•œ memberService ë¹ˆ ë“±ë¡ ì„¤ì •ì„ ì ìš©í•  ìˆ˜ ì—†ë‹¤ëŠ” ì˜¤ë¥˜ì…ë‹ˆë‹¤.

ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ê³¼ ìë™ ì˜ì¡´ê´€ê³„ ì„¤ì •ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì½”ë“œë¥¼ ì ìš©í–ˆìŠµë‹ˆë‹¤.

@Service

public class MemberService {}

ìë°” ì½”ë“œë¡œ ì§ì ‘ ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡í•˜ê¸°ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ @Serviceë¥¼ ì œê±°í–ˆìŠµë‹ˆë‹¤.

//@Service -> ì´ ë¼ì¸ì„ ì§€ì›Œì£¼ì„¸ìš”

public class MemberService {}

ì´ë ‡ê²Œ @Serviceë¥¼ ì œê±°í•´ì£¼ì‹œë©´ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì˜ ëŒ€ìƒì—ì„œ ì œì™¸ë˜ê¸° ë•Œë¬¸ì—, ì´í›„ë¶€í„°ëŠ” ì§ì ‘ ë¹ˆ ë“±ë¡ì„ ì§„í–‰í•˜ì…”ë„ ë êº¼ì—ìš”.


----------


### íšŒì› ê´€ë¦¬ ì˜ˆì œ

![20210605_212315](/assets/20210605_212315.png)

ê´€ë ¨ ì»¨íŠ¸ë¡¤ëŸ¬ ì°¾ê³  ì—†ìœ¼ë©´ ìŠ¤íƒœí‹± ì°¾ëŠ”ë‹¤ê³  ì„¤ëª…í–ˆë‹¤.

![20210605_212650](/assets/20210605_212650.png)

ì—¬ê¸°ì„œ ë§¤í•‘ëœê²Œ ìˆìœ¼ë‹ˆê¹Œ ë°”ë¡œ ì°¾ì•„ê°„ë‹¤.


íšŒì› ì›¹ ê¸°ëŠ¥ - í™ˆ í™”ë©´ ì¶”ê°€
í™ˆ ì»¨íŠ¸ë¡¤ëŸ¬ ì¶”ê°€
package hello.hellospring.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;

@Controller
public class HomeController {

    @GetMapping("/")
    public String home() {
        return "home";
    }

}
íšŒì› ê´€ë¦¬ìš© í™ˆ
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<body>
<div class="container">
  <div>
    <h1>Hello Spring</h1>
    <p>íšŒì› ê¸°ëŠ¥</p>
    <p>
      <a href="/members/new">íšŒì› ê°€ì…</a>
      <a href="/members">íšŒì› ëª©ë¡</a>
    </p>
  </div>
</div> <!-- /container -->
</body>
</html>
ì°¸ê³  : ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì •ì  íŒŒì¼(ex, index.html)ë³´ë‹¤ ìš°ì„ ìˆœìœ„ê°€ ë†’ë‹¤.

íšŒì› ì›¹ ê¸°ëŠ¥ - ë“±ë¡
íšŒì› ë“±ë¡ í¼ ê°œë°œ
íšŒì› ë“±ë¡ í¼ ì»¨íŠ¸ë¡¤ëŸ¬
@Controller                                                       
public class MemberController {                                   

    private final MemberService memberService;                    

    @Autowired                                                    
    public MemberController(MemberService memberService) {        
        this.memberService = memberService;                       
    }                                                             

    @GetMapping("/members/new")                                   
    public String createForm() {                                  
        return "members/createMemberForm";                        
    }                                                                                                                        

}
íšŒì› ë“±ë¡ í¼ HTML
(resources/templates/members/createMemberForm)
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<body>
<div class="container">
  <form action="/members/new" method="post">
    <div class="form-group">
      <label for="name">ì´ë¦„</label>
      <input type="text" id="name" name="name" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
    </div>
    <button type="submit">ë“±ë¡</button>
  </form>
</div> <!-- /container -->
</body>
</html>
íšŒì› ë“±ë¡ ì»¨íŠ¸ë¡¤ëŸ¬
ì›¹ ë“±ë¡ í™”ë©´ì—ì„œ ë°ì´í„°ë¥¼ ì „ë‹¬ ë°›ì„ í¼ ê°ì²´
package hello.hellospring.controller;

public class MemberForm {
    private String name;

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }
}
íšŒì› ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ íšŒì›ì„ ì‹¤ì œ ë“±ë¡í•˜ëŠ” ê¸°ëŠ¥
@PostMapping("/members/new")                                  
public String create(MemberForm form) {                       
    Member member = new Member();                             
    member.setName(form.getName());                           

    memberService.join(member);                               

    return "redirect:/";                                      
}
íšŒì›ê°€ì…ì„ ë“¤ì–´ê°€ë©´ members/newë¡œ ë“¤ì–´ì˜¨ë‹¤ (getë°©ì‹ìœ¼ë¡œ ê·¸ëƒ¥ ë“¤ì–´ì˜´)
â†’ createForm()ì„ ë°˜í™˜
â†’ ì •ì ìœ¼ë¡œ ìƒì„±ëœ members/createMemberForm.htmlì„ ê·¸ëƒ¥ ë¸Œë¼ìš°ì €ì— ë¿Œë ¤ì¤€ë‹¤.
â†’ ì´ ë•Œ inputíƒœê·¸ì•ˆì— ì…ë ¥í•œ ê°’ì„ ë‹´ì•„ì„œ (ì—¬ê¸°ì„œ nameì´ ì¤‘ìš”! serverë¡œ ë„˜ì–´ì˜¬ë•Œ keyê°€ ëœë‹¤.) postë°©ì‹ìœ¼ë¡œ ë‹¤ì‹œ ë„˜ì–´ì˜¨ë‹¤.
â†’ urlì€ ë˜‘ê°™ì§€ë§Œ ì´ë²ˆì—” post ë°©ì‹ì´ê¸° ë•Œë¬¸ì— postMappingëœ create() ë©”ì†Œë“œê°€ í˜¸ì¶œì´ ëœë‹¤.
â†’ memberFormì— ë°ì´í„°ë¥¼ ë‹´ì•„ì„œ join() ë©”ì†Œë“œë¥¼ í†µí•´ íšŒì›ê°€ì…ì„ í•œë‹¤.
íšŒì› ì›¹ ê¸°ëŠ¥ - ì¡°íšŒ
íšŒì› ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì¡°íšŒ ê¸°ëŠ¥
@GetMapping("/members")
public String list(Model model) {
    List<Member> members = memberService.findMembers();
    model.addAttribute("members", members);            
    return "members/memberList";                       
}
íšŒì› ë¦¬ìŠ¤íŠ¸ HTML
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<body>
<div class="container">
  <div>
    <table>
      <thead>
      <tr>
        <th>#</th>
        <th>ì´ë¦„</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="member : ${members}">
        <td th:text="${member.id}"></td>
        <td th:text="${member.name}"></td>
      </tr>
      </tbody>
    </table>
  </div>
</div> <!-- /container -->
</body>
</html>
<tr th:each="member : ${members}"> : ë°˜ë³µí•˜ëŠ” thymeleaf ë¬¸ë²•
Javaì˜ for Each ì™€ ë¹„ìŠ·
ì•„ì§ê¹Œì§€ëŠ” memoryì— ë°ì´í„°ë¥¼ ì €ì¥í–ˆê¸° ë•Œë¬¸ì— ì„œë²„ë¥¼ ë‚´ë ¸ë‹¤ ë‹¤ì‹œì¼œë©´ íšŒì›ë°ì´í„°ê°€ ë‹¤ ì‚¬ë¼ì§„ë‹¤.



![20210605_230326](/assets/20210605_230326.png)

í™”ë©´ì²˜ëŸ¼ ë‚˜ì™€ì•¼ í•˜ë©°

![20210605_225813](/assets/20210605_225813.png)


ì´ test.mv.dbê°€ ìˆì–´ì•¼ í•œë‹¤.

--------


ìˆœìˆ˜ Jdbc
í™˜ê²½ ì„¤ì •
build.gradle íŒŒì¼ì— jdbc, h2 ë°ì´í„°ë² ì´ìŠ¤ ê´€ë ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€

```
implementation 'org.springframework.boot:spring-boot-starter-jdbc'
runtimeOnly 'com.h2database:h2'
```
ìœ—ì¤„ì€ jdbcì™€ ì—°ê²°í•˜ëŠ”ê±°ê³ 
ë°‘ì€ ë””ë¹„ì™€ ë¶™ì„ë•Œ ë””ë¹„ê°€ ì œê³µí•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ í•„ìš”í•œë° ê·¸ê²ƒ.


ìŠ¤í”„ë§ ë¶€íŠ¸ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì„¤ì • ì¶”ê°€
resources/application.properties
spring.datasource.url=jdbc:h2:tcp://localhost/~/test
spring.datasource.driver-class-name=org.h2.Driver
spring.datasource.username=sa



---------

 - ì£¼ì˜!: ìŠ¤í”„ë§ë¶€íŠ¸ 2.4ë¶€í„°ëŠ” spring.datasource.username=sa ë¥¼ ê¼­ ì¶”ê°€í•´ì£¼ì–´ì•¼ í•œë‹¤. ê·¸ë ‡ì§€
ì•Šìœ¼ë©´ Wrong user name or password ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤. ì°¸ê³ ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ë§ˆì§€ë§‰ì— ê³µë°±ì´
ë“¤ì–´ê°€ë©´ ê°™ì€ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤. spring.datasource.username=sa ê³µë°± ì£¼ì˜, ê³µë°±ì€ ëª¨ë‘
ì œê±°í•´ì•¼ í•œë‹¤.


- ì°¸ê³ : ì¸í…”ë¦¬J ì»¤ë®¤ë‹ˆí‹°(ë¬´ë£Œ) ë²„ì „ì˜ ê²½ìš° application.properties íŒŒì¼ì˜ ì™¼ìª½ì´ ë‹¤ìŒ ê·¸ë¦¼ê³  ê°™ì´
íšŒìƒ‰ìœ¼ë¡œ ë‚˜ì˜¨ë‹¤. ì—”í„°í”„ë¼ì´ì¦ˆ(ìœ ë£Œ) ë²„ì „ì—ì„œ ì œê³µí•˜ëŠ” ìŠ¤í”„ë§ì˜ ì†ŒìŠ¤ ì½”ë“œë¥¼ ì—°ê²°í•´ì£¼ëŠ” í¸ì˜ ê¸°ëŠ¥ì´
ë¹ ì§„ ê²ƒì¸ë°, ì‹¤ì œ ë™ì‘í•˜ëŠ”ë°ëŠ” ì•„ë¬´ëŸ° ë¬¸ì œê°€ ì—†ë‹¤.

------------



![20210606_012343](/assets/20210606_012343.png)

MemberServiceëŠ” MemberRepositoryì— ì˜ì¡´
ê·¸ë¦¬ê³  MemberRepositoryëŠ” MemoryMemberRepositoryì™€ JDBCMemberRepositoryì— ì˜

![20210606_013233](/assets/20210606_013233.png)

ìŠ¤í”„ë§ì€ ê¸°ì¡´ì— Memory ë²„ì „ìœ¼ë¡œ ë“±ë¡í–ˆë‹¤ë©´ jdbcë¡œ ë“±ë¡í•œë‹¤.

### ê°œë°©-íì‡„ ì›ì¹™(OCP, Open-Closed Principle)

- í™•ì¥ì—ëŠ” ì—´ë ¤ìˆê³ , ìˆ˜ì •, ë³€ê²½ì—ëŠ” ë‹«í˜€ìˆë‹¤.
- ìŠ¤í”„ë§ì˜ DI (Dependencies Injection)ì„ ì‚¬ìš©í•˜ë©´ ê¸°ì¡´ ì½”ë“œë¥¼ ì „í˜€ ì†ëŒ€ì§€ ì•Šê³ , ì„¤ì •ë§Œìœ¼ë¡œ êµ¬í˜„
í´ë˜ìŠ¤ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.

- íšŒì›ì„ ë“±ë¡í•˜ê³  DBì— ê²°ê³¼ê°€ ì˜ ì…ë ¥ë˜ëŠ”ì§€ í™•ì¸í•˜ì.
ë°ì´í„°ë¥¼ DBì— ì €ì¥í•˜ë¯€ë¡œ ìŠ¤í”„ë§ ì„œë²„ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•´ë„ ë°ì´í„°ê°€ ì•ˆì „í•˜ê²Œ ì €ì¥ëœë‹¤.



```

@SpringBootTest
@Transactional

class MemberServiceIntegrationTest {
    @Autowired MemberService memberService;
    @Autowired MemberRepository memberRepository;
    @Test
    public void íšŒì›ê°€ì…() throws Exception {
    //Given
        Member member = new Member();
        member.setName("hello");
    //When
        Long saveId = memberService.join(member);
    //Then
        Member findMember = memberRepository.findById(saveId).get();
        assertEquals(member.getName(), findMember.getName());
    }
    @Test
    public void ì¤‘ë³µ_íšŒì›_ì˜ˆì™¸() throws Exception {
    //Given
        Member member1 = new Member();
        member1.setName("spring");
        Member member2 = new Member();
        member2.setName("spring");
    //When
        memberService.join(member1);
        IllegalStateException e = assertThrows(IllegalStateException.class,
                () -> memberService.join(member2));//ì˜ˆì™¸ê°€ ë°œìƒí•´ì•¼ í•œë‹¤.
        assertThat(e.getMessage()).isEqualTo("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íšŒì›ì…ë‹ˆë‹¤.");
    }
}

```

ì—¬ê¸°ì„œ @Transactionalì´ ë‚˜ì˜¤ëŠ”ë° ë©”ìš°ë©”ìš° ì¤‘ìš”í•˜ë‹¤.
ë””ë¹„ëŠ” ì»¤ë°‹ì„ í•´ì•¼ ì ìš© ë˜ëŠ”ë° ì´ íŠ¸ëœì­ì…˜ì€ ì»¤ë°‹ì„ ì•ˆí•˜ê³  ë¡¤ë°±ì„ í•´ì¤€ë‹¤. ê·¸ë˜ì„œ ì €ê±¸ ì£¼ì„ì²˜ë¦¬í•˜ê³  ì‹¤í–‰í•˜ë©´ ë””ë¹„ì— ì ìš©ì´ ì•ˆëœë‹¤.(ë¡¤ë°±í•´ì„œ)



@SpringBootTest : ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì™€ í…ŒìŠ¤íŠ¸ë¥¼ í•¨ê»˜ ì‹¤í–‰í•œë‹¤.(ì‹¤ì œì‹¤í–‰)

@Transactional : í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì— ì´ ì• ë…¸í…Œì´ì…˜ì´ ìˆìœ¼ë©´, í…ŒìŠ¤íŠ¸ ì‹œì‘ ì „ì— íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ê³ ,
í…ŒìŠ¤íŠ¸ ì™„ë£Œ í›„ì— í•­ìƒ ë¡¤ë°±í•œë‹¤. ì´ë ‡ê²Œ í•˜ë©´ DBì— ë°ì´í„°ê°€ ë‚¨ì§€ ì•Šìœ¼ë¯€ë¡œ ë‹¤ìŒ í…ŒìŠ¤íŠ¸ì— ì˜í–¥ì„ ì£¼ì§€
ì•ŠëŠ”ë‹¤.


------



### ìŠ¤í”„ë§ JdbcTemplate

- ìˆœìˆ˜ Jdbcì™€ ë™ì¼í•œ í™˜ê²½ì„¤ì •ì„ í•˜ë©´ ëœë‹¤.
- ìŠ¤í”„ë§ JdbcTemplateê³¼ MyBatis ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” JDBC APIì—ì„œ ë³¸ ë°˜ë³µ ì½”ë“œë¥¼ ëŒ€ë¶€ë¶„
ì œê±°í•´ì¤€ë‹¤. í•˜ì§€ë§Œ SQLì€ ì§ì ‘ ì‘ì„±í•´ì•¼ í•œë‹¤.

ì°¸ê³ ì§€ë§Œ

ìƒì„±ìê°€ 1ê°œë©´ @Autowired ìƒëµ ê°€ëŠ¥


----------


### JPA

jdbc->JdbcTemplateê¹Œì§€ ë°”ê¿”ë´¤ë‹¤. ê·¼ë° ë‹¤ ì¢‹ì€ë° JdbcTemplateë„ ê²°êµ­ ê°œë°œìê°€ ì§ì ‘ SQLì„ ì‘ì„±í•´ì•¼ í•œë‹¤.

JPA ì“°ë©´ ì¿¼ë¦¬ë„ JPAê°€ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•´ì¤Œ.

ê°ì²´ë¥¼ ë©”ëª¨ë¦¬ì— ë„£ë“¯ì´ JPAê°€ ì¿¼ë¦¬ë¥¼ ë‹¤ ì²˜ë¦¬í•´ì¤€ë‹¤.

ê·¸ëŸ¼ ìš°ë¦¬ëŠ” ê°ì²´ì¤‘ì‹¬ì˜ ì„¤ê³„ê°€ ê°€ëŠ¥í•´ì§„ë‹¤.


- JPAëŠ” ê¸°ì¡´ì˜ ë°˜ë³µ ì½”ë“œëŠ” ë¬¼ë¡ ì´ê³ , ê¸°ë³¸ì ì¸ SQLë„ JPAê°€ ì§ì ‘ ë§Œë“¤ì–´ì„œ ì‹¤í–‰í•´ì¤€ë‹¤.
- JPAë¥¼ ì‚¬ìš©í•˜ë©´, SQLê³¼ ë°ì´í„° ì¤‘ì‹¬ì˜ ì„¤ê³„ì—ì„œ ê°ì²´ ì¤‘ì‹¬ì˜ ì„¤ê³„ë¡œ íŒ¨ëŸ¬ë‹¤ì„ì„ ì „í™˜ì„ í•  ìˆ˜ ìˆë‹¤.
- JPAë¥¼ ì‚¬ìš©í•˜ë©´ ê°œë°œ ìƒì‚°ì„±ì„ í¬ê²Œ ë†’ì¼ ìˆ˜ ìˆë‹¤.

```
dependencies {
implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'
implementation 'org.springframework.boot:spring-boot-starter-web'
//implementation 'org.springframework.boot:spring-boot-starter-jdbc'
implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
runtimeOnly 'com.h2database:h2'
testImplementation('org.springframework.boot:spring-boot-starter-test') {
exclude group: 'org.junit.vintage', module: 'junit-vintage-engine'
}
}

```
spring-boot-starter-data-jpa ëŠ” ë‚´ë¶€ì— jdbc ê´€ë ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í¬í•¨í•œë‹¤. ë”°ë¼ì„œ jdbcëŠ” ì œê±°í•´ë„

```
spring.jpa.show-sql=true
spring.jpa.hibernate.ddl-auto=none

```

application.propertiesì— ì¶”ê°€í•´ì¤˜ì•¼ jpaê°€ ê°€ëŠ¥í•˜ë‹¤.


- show-sql : JPAê°€ ìƒì„±í•˜ëŠ” SQLì„ ì¶œë ¥í•œë‹¤.
- ddl-auto : JPAëŠ” í…Œì´ë¸”ì„ ìë™ìœ¼ë¡œ ìƒì„±í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ”ë° none ë¥¼ ì‚¬ìš©í•˜ë©´ í•´ë‹¹ ê¸°ëŠ¥ì„ ëˆë‹¤.
create ë¥¼ ì‚¬ìš©í•˜ë©´ ì—”í‹°í‹° ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ í…Œì´ë¸”ë„ ì§ì ‘ ìƒì„±í•´ì¤€ë‹¤. í•´ë³´ì.


ì—”í‹°í‹° ì“°ë ¤ë©´ ì—”í‹°í‹° ë§¤ë‹ˆì €ë¥¼ ì£¼ì…ë°›ì•„ì•¼ í•œë‹¤.

em ì—ì„œ ì˜êµ¬ ì €ì¥í•˜ë‹¤ (ì˜ì†ì„±)


--------

### AOP (Cì˜ í¬ì¸í„°ë§ˆëƒ¥ ë°©ì§€í„±)

```
package hello.hellospring.service;


import hello.hellospring.domain.Member;
import hello.hellospring.repository.MemberRepository;

import java.util.List;
import java.util.Optional;

//@Service
public class MemberService{
//    private final MemberRepository memberRepository = new MemoryMemberRepository();


    private final MemberRepository memberRepository;

    public MemberService(MemberRepository memberRepository){
        this.memberRepository = memberRepository;
    }

    /*íšŒì›ê°€ì…*/
    public Long join(Member member) {
        //ê°™ì€ ì´ë¦„ì´ ìˆëŠ” ì¤‘ë³µíšŒì› X
        long start = System.currentTimeMillis();

//        Optional<Member> result = memberRepository.findByName(member.getName());
        //ì˜µì…”ë„ë¡œ ë°˜í™˜
        try {
            validateDuplicateMember(member);

            memberRepository.save(member);
            return member.getId();
        }finally{
            long finish = System.currentTimeMillis();
            long timeMs=finish-start;
            System.out.println("join="+timeMs+"ms");
        }
    }

    private void validateDuplicateMember(Member member) {
        memberRepository.findByName(member.getName())
                .ifPresent(m->{   //ë§Œì•½ ë©¤ë²„ì— ê°’ì´ ìˆìœ¼ë©´
                throw new IllegalStateException("ì´ë¯¸ ì¡´ì¬í•˜ëŠ” íšŒì›ì…ë‹ˆë‹¤");
        });
    }

    /*ì „ì²´ íšŒì› ì¡°íšŒ*/

    public List<Member> findMembers() {
        long start = System.currentTimeMillis();
        try {
            return memberRepository.findAll();
        }finally {
            long finish = System.currentTimeMillis();
            long timeMs = finish-start;
            System.out.println("findMember"+timeMs+"ms");
        }

    }
    public Optional<Member> findOne(Long memberId) {
        return memberRepository.findById(memberId);
    }
}


```

íšŒì›ê°€ì…, íšŒì› ì¡°íšŒë“± í•µì‹¬ ê´€ì‹¬ì‚¬í•­ê³¼ ì‹œê°„ì„ ì¸¡ì •í•˜ëŠ” ê³µí†µ ê´€ì‹¬ ì‚¬í•­ì„ ë¶„ë¦¬í•œë‹¤.
ì‹œê°„ì„ ì¸¡ì •í•˜ëŠ” ë¡œì§ì„ ë³„ë„ì˜ ê³µí†µ ë¡œì§ìœ¼ë¡œ ë§Œë“¤ì—ˆë‹¤.
í•µì‹¬ ê´€ì‹¬ ì‚¬í•­ì„ ê¹”ë”í•˜ê²Œ ìœ ì§€í•  ìˆ˜ ìˆë‹¤.
ë³€ê²½ì´ í•„ìš”í•˜ë©´ ì´ ë¡œì§ë§Œ ë³€ê²½í•˜ë©´ ëœë‹¤.
ì›í•˜ëŠ” ì ìš© ëŒ€ìƒì„ ì„ íƒí•  ìˆ˜ ìˆë‹¤.


### ìŠ¤í”„ë§ì˜ AOP ë™ì‘ ë°©ì‹ ì„¤ëª…
#### AOP ì ìš© ì „ ì˜ì¡´ê´€ê³„


![20210606_152517](/assets/20210606_152517.png)


![20210606_152533](/assets/20210606_152533.png)


#### AOP ì ìš© ì „ ì „ì²´ ê·¸ë¦¼

![20210606_152551](/assets/20210606_152551.png)

Hello COntrollerê°€ í˜¸ì¶œí•˜ëŠ”ê±´ ê°€ì§œìŠ¤í”„ë§ë¹ˆ í•´ì„œ ì§„ì§œ ë©¤ë²„ì„œë¹„ìŠ¤ê°€ ì•„ë‹ˆë¼ í”„ë¡ì‹œë¡œ ë°œìƒí•˜ëŠ” ê°€ì§œ ë©¤ë²„ì„œë¹„ìŠ¤ë¥¼ í˜¸ì¶œ.

#### AOP ì ìš© í›„ ì „ì²´ ê·¸ë¦¼

![20210606_152616](/assets/20210606_152616.png)


![20210606_154344](/assets/20210606_154344.png)

ì´ëŸ¬ë©´ ì–´ë””ì„œ ë°€ë¦¬ëŠ”ì§€ ì–´ë””ì„œ ë³‘ëª©ì´ ë‚˜ì˜¤ëŠ”ì§€ ë‹¤ ì½˜ì†”ì°½ì— ë‚˜ì˜¨ë‹¤.

ì´ëŸ°ì‹ìœ¼ë¡œ ì œê³µë˜ëŠ”ê²Œ SearchBoardRepository
í˜¸ì¶œì´ ë ë–„ë§ˆ ì—¬ê¸°ë¡œ jouinPointì—ë‹¤ ì¡°ì‘ ê°€ëŠ¥.
