---
title: "[C] C lang 레지스터, 스택 & 힙, 동적 메모리. 다중 포인터
"
layout: post
subtitle: C
date: "2022-03-18-08:42:51 +0900"

categories: study
tags: C
# layout: post
# title:  WebFrontEnd
# subtitle:   "시작하기"
# categories: study
# tags: java
comments: true
---

### 메모리의 종류

#### 프로그램에서 자주 사용하는 부품

1 . CPU
- 모든 코드의 로직(연산)을 실행하는 장치
- 컴퓨터에서 가장 핵심적인 두뇌라 할 수 있다.

2 . 메모리

- 실행중인 코드 및 연산의 중간 결과등을 저장하는 공간
- 변수나 배열 등에 대입되는 데이터가 저장됨

- 무언가를 저장한다는 점에서 메모장과 유사하다.

![20221119_233242](https://user-images.githubusercontent.com/37941513/202855988-d2ad4446-8bc9-4834-956c-e815bc2fccf2.png)


#### 메모리는 또 다쉬 나뉨

- 프로그램 중 여러 데이터가 공유하는 메모리는 둘로 나뉨.

  - 스택(stack)메모리 
  - 힙(heap) 메모리

- 사실상 이 둘 물리적으로 같은 메모리

- 이 외에 데이터 섹션, 코드 섹션 등 있으나 그건 특정 코드 및 데이터 용으로 고정


<br>


-----------

#### 기본은 힙 메모리

- 힙 메모리가 범용적인 기본형태


<br>

-----

<br>

--------

#### 스택은 특별한 용도를 가진 메모리

- 프로그램 마다 특별한 용도에 사용하라고 별도로 떼어놔준게 스택 메모리

  - 엄밀히 말하면 프로그램마다가 아니라 그 프로그램의 쓰레드이다.



#### 그리고 CPU안에도 저장공간이 있다.

- 레지스터: CPU에서만 사용할 수 있는 고속 저장공간

- 엄밀한 의미의 메모리는 아님.


<br>

-----

### 스택 메모리

![20221119_234442](https://user-images.githubusercontent.com/37941513/202856563-13ca9830-6f1c-4453-84e7-9aa6f4aa844e.png)


- 좀 더 알고 싶다면 함수를 호출 할 때 스택에 대해 어떻게 돌아가는 지 는 함수 호출 규약 (calling convention) 에 따라 달라짐

  - 구조체 배울 떄 매개변수 4개까지는 값으로 전달하라는 회사 이야기를 했는데 이건 특정 호출 규약에서 성능 향상이 가능한 부분이기 떄문


- 함수 호출규약에 대한 자세한 정보는 coding convention으로 구글 검색


### 레지스터

- CPU가 뇌, 메모리가 공책이면 뇌에서 생각한 걸 공책에 옮기려면 시간이 걸리듯, CPU가 생각한 걸 메모리에 적거나 그로부터 읽을때도 시간이 걸림

#### 메모리를 읽고 쓰는 게 느린 이유1

- CPU가 메모리에 접근 할 때마다 버스 타야됨
- 즉, CPU가 연산할 때마다 메모리에 접근하는 시간이 발생

  - 버스가 크면 한번에 많이 읽지만 메모리 낭비가 생기고
  - 버스가 작으면 메모리 낭비는 적을 수 있겠지만 여러번 왔다갔다함.


  #### 메모리를 읽고 쓰는 게 느린 이유2

  - 대부분 컴퓨터에 장착하는 메모리는 DRAM
    - 영어로는 Dynamic Random Access Memory

  - Dram은 가격이 저렴한 대신 단점이 있다.
    - 기록한 내용을 유지하기 위해 주기적으로 정보를 다시 써야함
    - 다시 쓰는 동안 또 시간을 소모

  - 이러한 단점이 없는 메모리가 SRAM
    - static Ram
    - Dram에 비해 훨씬 비쌈
    - 이걸 몇기가 달기에는 부담

#### 더 나은 방식을 찾기위해 고민함
  
- 그래서 비용은 저렴하지만 속도가 빠른 컴퓨터들을 만들기 위해 고민

- 그래서 나온 방법이 Sram을 cpu와 메모리 사이에 두는 것
  - 단, 너무 비싸니 매우 적은 용량만
  - 일반적인 sram과는 다름

- CPU랑 가까이 두고 싶어서 아예 CPU안에 넣어버림
- 그게 레지스터다


<br>

-------


### 레지스터

- 레지스터는 CPU가 사용하는 저장공간 중 가장 빠른 저장공간

- CPU가 연산시 보통 레지스터에 저장된 레지스터를 사용

- 그 연산 결과도 레지스터에 다시 저장하는 것이 보통이다
- 레지스터는 흔히 말하는 메모리가 아님
  - cpu가 레지스터에 접근하는 방식과 메모리에 접근하는 방식이 다르다

  ![20221120_021638](https://user-images.githubusercontent.com/37941513/202863291-bccdc330-e066-4805-94e9-c15fd9730d29.png)



<br>

----------

